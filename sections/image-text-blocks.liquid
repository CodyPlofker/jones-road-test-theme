{%- assign config = section.settings -%}
{%- assign blocks = section.blocks | map: 'settings' -%}

<div id="{{ config.section_id }}" class="image-text-blocks" data-component="imageTextBlocks">
  {%- if config.heading != blank -%}
    <h2 class="image-text-blocks__heading">{{ config.heading }}</h2>
  {%- endif -%}
  <div class="image-text-blocks__blocks {{ config.gap }}">
    {%- for block in blocks -%}
      <div class="image-text-blocks__block {{ block.orientation }}">
        <div class="image-text-blocks__image">
          <div class="img">
            {{ block.image | image_url: width: 1440 | image_tag: width: 720, loading: 'lazy' }}
          </div>
        </div>
        <div class="image-text-blocks__content">
          <p class="number">{{ forloop.index | append: '.' }}</p>
          {%- if block.heading != blank -%}
            <h3 class="heading">{{ block.heading }}</h3>
          {%- endif -%}
          {%- if block.description != blank -%}
            <div class="description text-underline">{{ block.description }}</div>
          {%- endif -%}
        </div>
      </div>
    {%- endfor -%}
  </div>
  {%- if config.cta_text != blank -%}
    {%- assign is_permalink = false -%}
    {%- if config.cta_link contains '#' -%}
      {%- assign is_permalink = true -%}
    {%- endif -%}
    <a href="{{ config.cta_link }}" class="image-text-blocks__button button {% if is_permalink %} js-smoothScroll {% endif %}" style="--bg: {{ config.cta_background }}; --color: {{ config.cta_color }};">
      {{ config.cta_text }}
    </a>
  {%- endif -%}
</div>

{% schema %}
  {
    "name": "Image & Text Blocks",
    "settings": [
      {
        "type": "header",
        "content": "Settings"
      },
      {
        "type": "text",
        "id": "section_id",
        "label": "Section ID",
        "info": "Used to create a permalink to the section. Must be unique to the section, all lower-case, with hyphens instead of spaces.",
        "default": "image-text-blocks"
      },
      {
        "type": "select",
        "id": "gap",
        "label": "Show Gap",
        "options": [
          { "label": "Mobile & Desktop", "value": "gap-mobile gap-desktop" },
          { "label": "Mobile", "value": "gap-mobile" },
          { "label": "Desktop", "value": "gap-desktop" },
          { "label": "None", "value": "gap-none" }
        ],
        "default": "gap-mobile gap-desktop"
      },
      {
        "type": "header",
        "content": "Heading"
      },
      {
        "type": "text",
        "id": "heading",
        "label": "Heading"
      },
      {
        "type": "color",
        "id": "heading_color",
        "label": "Heading Color",
        "default": "#000"
      },
      {
        "type": "header",
        "content": "CTA"
      },
      {
        "type": "text",
        "id": "cta_text",
        "label": "CTA Text"
      },
      {
        "type": "url",
        "id": "cta_link",
        "label": "CTA Link",
        "info": "To create a permalink to another section, enter # followed by the ID of the section you want to link to, eg: #product-grid"
      },
      {
        "type": "color",
        "id": "cta_color",
        "label": "CTA Color",
        "default": "#fff"
      },
      {
        "type": "color",
        "id": "cta_background",
        "label": "CTA Background",
        "default": "#000"
      }
    ],
    "blocks": [
      {
        "type": "image-text",
        "name": "Image & Text",
        "settings": [
          {
            "type": "header",
            "content": "Settings"
          },
          {
            "type": "select",
            "id": "orientation",
            "label": "Orientation (desktop)",
            "options": [
              { "label": "Image on Left", "value": "standard" },
              { "label": "Image on Right", "value": "reversed" }
            ]
          },
          {
            "type": "header",
            "content": "Content"
          },
          {
            "type": "image_picker",
            "id": "image",
            "label": "Image"
          },
          {
            "type": "text",
            "id": "heading",
            "label": "Heading"
          },
          {
            "type": "richtext",
            "id": "description",
            "label": "Description"
          }
        ]
      }
    ],
    "presets": [{ "name": "Image & Text Blocks" }]
  }
{% endschema %}