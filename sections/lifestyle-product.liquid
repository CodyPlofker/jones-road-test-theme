{%- assign config = section.settings -%}

<div class="lifestyle-product--inner js-lifestyleProduct" data-component="lifestyleProduct">
  <div class="lifestyle-product--content">
    {%- if config.heading != blank -%}
      <h2 class="lifestyle-product--heading">
        {{ config.heading }}
      </h2>
    {%- endif -%}
    {%- if config.description != blank -%}
      <div class="lifestyle-product--description text-underline">
        {{ config.description }}
      </div>
    {%- endif -%}
    {%- if config.product != blank -%}
      {%- assign current_variant = config.product.selected_or_first_available_variant -%}
      <div class="lifestyle-product--product">
        <div class="lifestyle-product--product-info">
          <h3>
            <a href="{{ config.product.url | append: '?country=' | append: localization.country.iso_code }}">
              {{ config.product.title }}
            </a>
          </h3>
          {%- unless config.product.has_only_default_variant -%}
            <div class="product-options js-productForm">
              {%- for option in config.product.options_with_values -%}
                {%- assign option_id = 'option' | append: option.position -%}
                {%- assign input_name = option_id | append: '-' | append: section.id -%}
                {%- assign selected_value = current_variant[option_id] -%}
                <div class="product-option" data-type="radio">
                  <p class="product-option--selected js-lifestyleProdSelected" data-option="{{ option_id }}">
                    {{ selected_value }}
                  </p>
                  <ul class="product-option--values">
                    {%- for value in option.values -%}
                      {%- assign value_id = value | handleize | append: '-' | append: section.id -%}
                      {%- include 'product-swatch' with 
                        is_findation: false,
                        option_id,
                        id: value_id,
                        is_hidden: false,
                        is_available: true,
                        product: config.product,
                        input_name_override: input_name,
                        selected_value
                      -%}
                    {%- endfor -%}
                  </ul>
                </div>
              {%- endfor -%}
            </div>
          {%- endunless -%}
          <a 
            href="{{ config.product.url | append: '?country=' | append: localization.country.iso_code }}"
            class="button js-lifestyleProductButton"
            {%- for option in config.product.options_with_values -%}
              {%- assign option_id = 'option' | append: forloop.index -%}
              {%- for value in option.values -%}
                {%- assign variant_with_value = config.product.variants | where: option_id, value | first -%}
                data-{{ value }}="{{ variant_with_value.url | append: '?country=' | append: localization.country.iso_code }}"
              {%- endfor -%}
            {%- endfor -%}
          >
            Shop Now
          </a>
        </div>
        <div class="lifestyle-product--product-image">
          {%- if config.product.has_only_default_variant -%}
            <figure class="selected">
              {%- render 'component_image',
                image: config.product.featured_image,
                width: 370,
                widths: '140, 185, 280, 370',
                sizes: '(min-width: 768px) 185px, 50vw'
              -%}
            </figure>
          {%- else -%}
            {%- for variant in config.product.variants -%}
              <figure 
                class="js-lifestyleImage {% if variant.id == current_variant.id %} selected {% endif %}"
                {%- for option in config.product.options -%}
                  {%- assign option_id = 'option' | append: forloop.index -%}
                  data-{{ option_id }}="{{ variant[option_id] }}"
                {%- endfor -%}
              >
                {%- render 'component_image',
                  image: variant.image,
                  width: 370,
                  widths: '140, 185, 280, 370',
                  sizes: '(min-width: 768px) 185px, 50vw'
                -%}
              </figure>
            {%- endfor -%}
          {%- endif -%}
        </div>
      </div>
    {%- endif -%}
  </div>
  <div class="lifestyle-product--image">
    <figure class="image">
      {%- if config.image != blank -%}
        {%- render 'component_image',
          image: config.image,
          width: 1500,
          widths: '375, 550, 750, 1100, 1500',
          sizes: '(min-width: 768px) 50vw, 100vw'
        -%}
      {%- endif -%}
    </figure>
    {%- if config.swatch != blank -%}
      <figure class="swatch">
        {%- render 'component_image',
          image: config.swatch,
          width: 440,
          widths: '116, 220, 440',
          sizes: '(min-width: 768px) 220px, 116px'
        -%}
      </figure>
    {%- endif -%}
  </div>
</div>

{%- schema -%}
  {
    "name": "Lifestyle Product",
    "tag": "section",
    "class": "lifestyle-product",
    "settings": [
      {
        "type": "header",
        "content": "Content"
      },
      {
        "type": "text",
        "id": "heading",
        "label": "Heading"
      },
      {
        "type": "richtext",
        "id": "description",
        "label": "Description",
        "info": "Format headings as Heading 3."
      },
      {
        "type": "product",
        "id": "product",
        "label": "Product"
      },
      {
        "type": "header",
        "content": "Images"
      },
      {
        "type": "image_picker",
        "id": "image",
        "label": "Lifestyle Image"
      },
      {
        "type": "image_picker",
        "id": "swatch",
        "label": "Product Swatch",
        "info": "Displays in the top right corner of the product image"
      }
    ],
    "presets": [
      {
        "name": "Lifestyle Product",
        "settings": {
          "heading": "A Nude Classic",
          "description": "<p>Nude lips are making a statement this holiday. The Lip Kit is a bundle of three effortless lip products designed for any occasion. Wear them alone casually or pair them together for a greater statement. Each Lip Kit includes a Lip Pencil, a modern, creamy pencil designed to line and color in your lips, a Lip Tint, which is a moisturizing stick that provides a bolder wash of color, and a Cool Gloss for a minty, high-shine finish.</p>",
          "product": "the-lip-kit",
          "image": "shopify:\/\/shop_images\/jr-lifestyle-1.jpg",
          "swatch": "shopify:\/\/shop_images\/jr-lifestyle-swatch-1.png"
        }
      }
    ]
  }
{%- endschema -%}