{%- assign config = section.settings -%}
{%- assign steps = section.blocks | map: 'settings' -%}

<div
  id="stepped-image-{{ section.id }}"
  class="stepped__image js-steppedImage"
  data-component="steppedImage"
>
  <div class="stepped__image-inner">
    <div class="stepped__image-main">
      {%- if config.heading != blank -%}
        <h2 class="stepped__image-heading">{{ config.heading }}</h2>
      {%- endif -%}
      {%- if steps.size > 0 -%}
        <ul class="stepped__image-steps">
          {%- for step in steps -%}
            <li class="stepped__image-step js-steppedImageStep {% if forloop.first %} active {% endif %}" data-index="{{ forloop.index }}">
              <span class="stepped__image-step--index">
                {{ forloop.index }}
              </span>
              <div class="stepped__image-step--info">
                {%- if step.heading != blank -%}
                  <h3 class="stepped__image-step--heading">{{ step.heading }}</h3>
                {%- endif -%}
                {%- if step.description != blank -%}
                  <p class="stepped__image-step--description">
                    {{ step.description }}
                  </p>
                {%- endif -%}
                {%- if step.image != blank -%}
                  <div class="stepped__image-step--image">
                    {{ step.image | image_url: width: 1000 | image_tag: sizes: '100vw' }}
                  </div>
                {%- endif -%}
              </div>
            </li>
          {%- endfor -%}
        </ul>
      {%- endif -%}
    </div>
    <div class="stepped__image-image" role="presentation">
      <div class="stepped__image-image--inner">
        {%- for step in steps -%}
          <figure 
            class="stepped__image-image--image {% if forloop.first %} active {% endif %} js-steppedImageImage"
            data-index="{{ forloop.index }}"
          >
            {%- if step.image != blank -%}  
              {{ step.image | image_url: width: 1000 | image_tag: sizes: '50vw' }}
            {%- endif -%}
          </figure>
        {%- endfor -%}
      </div>
    </div>
  </div>
</div>

{%- schema -%}
  {
    "name": "Stepped Image",
    "tag": "section",
    "settings": [
      {
        "type": "header",
        "content": "Settings"
      },
      {
        "type": "header",
        "content": "Content"
      },
      {
        "type": "text",
        "id": "heading",
        "label": "Section Heading"
      }
    ],
    "blocks": [
      {
        "type": "step",
        "name": "Step",
        "settings": [
          {
            "type": "header",
            "content": "Content"
          },
          {
            "type": "image_picker",
            "id": "image",
            "label": "Image"
          },
          {
            "type": "text",
            "id": "heading",
            "label": "Heading"
          },
          {
            "type": "inline_richtext",
            "id": "description",
            "label": "Description"
          }
        ]
      }
    ],
    "presets": [{ "name": "Stepped Image" }]
  }
{%- endschema -%}