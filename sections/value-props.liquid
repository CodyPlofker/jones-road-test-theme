{%- assign config = section.settings -%}
{%- assign value_props = section.blocks | map: 'settings' -%}

<div id="{{ config.section_id }}" class="value-props" data-component="valueProps" style="background: {{ config.background }};">
  {%- if config.heading != blank -%}
    <h1 class="value-props__heading {% if config.show_highlight %} highlight {% endif %}" style="--highlight: {{ config.heading_highlight }}; --color: {{ config.heading_color }};">
      <span>{{ config.heading | newline_to_br }}</span>
    </h1>
  {%- endif -%}
  <div class="value-props__props {{ config.gap }}">
    {%- for prop in value_props -%}
      <div class="value-props__prop {{ config.mobile_layout }} {{ config.text_align }}">
        {%- if prop.image != blank -%}
          <div class="prop-image">
            <div class="{{ config.aspect_ratio }}">
              {{ prop.image | image_url: width: 1000 | image_tag: width: 1000, class: 'aspect-child', loading: 'lazy' }}
            </div>
          </div>
        {%- endif -%}
        {%- if prop.heading != blank or prop.description != blank -%}
          <div class="prop-content">
            {%- if prop.heading != blank -%}
              <h2 class="heading" style="--color: {{ prop.heading_color }};{% if prop.cap_heading %} --width: {{ prop.heading_width | append: 'px' }}; {% endif %}">
                {{ prop.heading }}
              </h2>
            {%- endif -%}
            {%- if prop.description != blank -%}
              <div class="description text-underline" style="--color: {{ prop.description_color }};">{{ prop.description }}</div>
            {%- endif -%}
          </div>
        {%- endif -%}
      </div>
    {%- endfor -%}
  </div>
  {%- if config.cta_text != blank -%}
    {%- assign is_permalink = false -%}
    {%- if config.cta_link contains '#' -%}
      {%- assign is_permalink = true -%}
    {%- endif -%}
    <a href="{{ config.cta_link }}" class="value-props__button button {% if is_permalink %} js-smoothScroll {% endif %}" style="--bg: {{ config.cta_background }}; --color: {{ config.cta_color }};">
      {{ config.cta_text }}
    </a>
  {%- endif -%}
</div>

{% schema %}
  {
    "name": "Value Props",
    "max_blocks": 3,
    "settings": [
      {
        "type": "header",
        "content": "Settings"
      },
      {
        "type": "text",
        "id": "section_id",
        "label": "Section ID",
        "info": "Used to create a permalink to the section. Must be unique to the section, all lower-case, with hyphens instead of spaces.",
        "default": "value-props"
      },
      {
        "type": "color",
        "id": "background",
        "label": "Background",
        "default": "#fff"
      },
      {
        "type": "select",
        "id": "mobile_layout",
        "label": "Layout (mobile)",
        "options": [
          { "label": "Content under Image", "value": "column" },
          { "label": "Content next to Image", "value": "row" }
        ]
      },
      {
        "type": "select",
        "id": "text_align",
        "label": "Text Alignment",
        "options": [
          { "label": "Center", "value": "text-center" },
          { "label": "Left", "value": "text-left" }
        ]
      },
      {
        "type": "select",
        "id": "gap",
        "label": "Show Gap",
        "options": [
          { "label": "Mobile & Desktop", "value": "gap-mobile gap-desktop" },
          { "label": "Mobile", "value": "gap-mobile" },
          { "label": "Desktop", "value": "gap-desktop" },
          { "label": "None", "value": "gap-none" }
        ],
        "default": "gap-mobile gap-desktop"
      },
      {
        "type": "select",
        "id": "aspect_ratio",
        "label": "Image Aspect Ratio",
        "options": [
          { "label": "Square", "value": "aspect-1-1" },
          { "label": "Portrait", "value": "aspect-4-5" }
        ]
      },
      {
        "type": "header",
        "content": "Heading"
      },
      {
        "type": "textarea",
        "id": "heading",
        "label": "Heading"
      },
      {
        "type": "color",
        "id": "heading_color",
        "label": "Heading Color",
        "default": "#000"
      },
      {
        "type": "color",
        "id": "heading_highlight",
        "label": "Heading Highlight",
        "default": "#fff"
      },
      {
        "type": "checkbox",
        "id": "show_highlight",
        "label": "Show Highlight"
      },
      {
        "type": "header",
        "content": "CTA"
      },
      {
        "type": "text",
        "id": "cta_text",
        "label": "CTA Text"
      },
      {
        "type": "url",
        "id": "cta_link",
        "label": "CTA Link",
        "info": "To create a permalink to another section, enter # followed by the ID of the section you want to link to, eg: #product-grid"
      },
      {
        "type": "color",
        "id": "cta_color",
        "label": "CTA Color",
        "default": "#fff"
      },
      {
        "type": "color",
        "id": "cta_background",
        "label": "CTA Background",
        "default": "#000"
      }
    ],
    "blocks": [
      {
        "type": "value-prop",
        "name": "Value Prop",
        "settings": [
          {
            "type": "header",
            "content": "Settings"
          },
          {
            "type": "checkbox",
            "id": "cap_heading",
            "label": "Cap heading width",
            "info": "Desktop only. Check this box and use the selector below to cap the width of the heading."
          },
          {
            "type": "range",
            "id": "heading_width",
            "label": "Heading Width (desktop only)",
            "min": 170,
            "max": 270,
            "step": 10,
            "unit": "px",
            "default": 260
          },
          {
            "type": "color",
            "id": "heading_color",
            "label": "Heading Color",
            "default": "#000"
          },
          {
            "type": "color",
            "id": "description_color",
            "label": "Description Color",
            "default": "#000"
          },
          {
            "type": "header",
            "content": "Content"
          },
          {
            "type": "image_picker",
            "id": "image",
            "label": "Image"
          },
          {
            "type": "text",
            "id": "heading",
            "label": "Heading"
          },
          {
            "type": "richtext", // EE
            "id": "description",
            "label": "Description"
          }
        ]
      }
    ],
    "presets": [{ "name": "Value Props" }]
  }
{% endschema %}